#!/usr/bin/env python
'''
OVERVIEW:
Test script for sending UDP commands.
 
AUTHORS:
Bronson Edralin <bedralin@hawaii.edu> & Isar Mostafanezhad
University of Hawaii at Manoa
Instrumentation Development Lab (IDLab), WAT214
DESCRIPTION:
chmod +x tst_sendUDP.py
./tst_sendUDP.py
'''




import sys
import os
SCRIPTPATH = os.path.dirname(__file__)
sys.path.append( SCRIPTPATH+'/lib/' )
import linkEth
import time

usageMSG="Usage: setMBTXConfig <interface> \n This command will set the config parameters of all the ASICs on the MB";
if len(sys.argv)!=2:
	print usageMSG
	exit(-1)



# Ethernet Configuration
addr_fpga = '192.168.20.5'
addr_pc = '192.168.20.1'
port_pc = '28672'
port_fpga = '24576'
interface = sys.argv[1]

# Make UDP class for receiving/sending UDP Packets
ctrl = linkEth.UDP(addr_fpga, port_fpga, addr_pc, port_pc, interface)

ctrl.open()
syncwd="000000010253594e4300000000"

cmd_pre="01234567AE000100AF000000AE000100AF008000AE000100AE008000AE000100"+\
"AE000100AF00FFFFAE000100AE000100AF008000AE000100AF050080AE000100"+\
"AF060140AE000100B00005AAB00205AAB00405AAB00605AAB00805AAB00A05AA";

cmd_ag1="B00C05AAB00E05AAB01005AAB01205AAB01405AAB01605AAB01805AAB01A05AA"+\
"B01C05AAB01E05AAB00103D9B00303D9B00503D9B00703D9B00903D9B00B03D9"+\
"B00D03D9B00F03D9B01103D9B01303D9B01503D9B01703D9B01903D9B01B03D9"+\
"B01D03D9B01F03D9B0300514B0310000B0320A5AB033044CB03405DCB0350426"+\
"B03604B9B0370000B0380480B0390000B03A08BBB03B0000B03D04A6B03E044C"+\
"B03F044CB040008FB04100A3B042000DB0430021B0440014B0450028B0460021"+\
"B0470035B0480038B049000CB04A0028B04B003AB04C02E1B04D0C28B04E0480"+\
"B04F0AAAB10005AAB10205AAB10405AAB10605AAB10805AAB10A05AAB10C05AA"+\
"B10E05AAB11005AAB11205AAB11405AAB11605AAB11805AAB11A05AAB11C05AA"+\
"B11E05AAB10103D9B10303D9B10503D9B10703D9B10903D9B10B03D9B10D03D9"+\
"B10F03D9B11103D9B11303D9B11503D9B11703D9B11903D9B11B03D9B11D03D9"+\
"B11F03D9B1300514B1310000B1320A5AB133044CB13405DCB1350426B13604B9"+\
"B1370000B1380480B1390000B13A08BBB13B0000B13D04A6B13E044CB13F044C"+\
"B140008FB14100A3B142000DB1430021B1440014B1450028B1460021B1470035"+\
"B1480038B149000CB14A0028B14B003AB14C02E1B14D0C28B14E0480B14F0AAA"+\
"B20005AAB20205AAB20405AAB20605AAB20805AAB20A05AAB20C05AAB20E05AA"+\
"B21005AAB21205AAB21405AAB21605AAB21805AAB21A05AAB21C05AAB21E05AA"+\
"B20103D9B20303D9B20503D9B20703D9B20903D9B20B03D9B20D03D9B20F03D9"+\
"B21103D9B21303D9B21503D9B21703D9B21903D9B21B03D9B21D03D9B21F03D9"+\
"B2300514B2310000B2320A5AB233044CB23405DCB2350426B23604B9B2370000"+\
"B2380480B2390000B23A08BBB23B0000B23D04A6B23E044CB23F044CB240008F"+\
"B24100A3B242000DB2430021B2440014B2450028B2460021B2470035B2480038"+\
"B249000CB24A0028B24B003AB24C02E1B24D0C28B24E0480B24F0AAAB30005AA"+\
"B30205AAB30405AAB30605AAB30805AAB30A05AAB30C05AAB30E05AAB31005AA"+\
"B31205AAB31405AAB31605AAB31805AAB31A05AAB31C05AAB31E05AAB30103D9"+\
"B30303D9B30503D9B30703D9B30903D9B30B03D9B30D03D9B30F03D9B31103D9"+\
"B31303D9B31503D9B31703D9B31903D9B31B03D9B31D03D9B31F03D9B3300514"+\
"B3310000B3320A5AB333044CB33405DCB3350426B33604B9B3370000B3380480"+\
"B3390000B33A08BBB33B0000B33D04A6B33E044CB33F044CB340008FB34100A3"+\
"B342000DB3430021B3440014B3450028B3460021B3470035B3480038B349000C"+\
"B34A0028B34B003AB34C02E1B34D0C28B34E0480B34F0AAAB40005AAB40205AA";

cmd_ag2="B40405AAB40605AAB40805AAB40A05AAB40C05AAB40E05AAB41005AAB41205AA"+\
"B41405AAB41605AAB41805AAB41A05AAB41C05AAB41E05AAB40103D9B40303D9"+\
"B40503D9B40703D9B40903D9B40B03D9B40D03D9B40F03D9B41103D9B41303D9"+\
"B41503D9B41703D9B41903D9B41B03D9B41D03D9B41F03D9B4300514B4310000"+\
"B4320A5AB433044CB43405DCB4350426B43604B9B4370000B4380480B4390000"+\
"B43A08BBB43B0000B43D04A6B43E044CB43F044CB440008FB44100A3B442000D"+\
"B4430021B4440014B4450028B4460021B4470035B4480038B449000CB44A0028"+\
"B44B003AB44C02E1B44D0C28B44E0480B44F0AAAB50005AAB50205AAB50405AA"+\
"B50605AAB50805AAB50A05AAB50C05AAB50E05AAB51005AAB51205AAB51405AA"+\
"B51605AAB51805AAB51A05AAB51C05AAB51E05AAB50103D9B50303D9B50503D9"+\
"B50703D9B50903D9B50B03D9B50D03D9B50F03D9B51103D9B51303D9B51503D9"+\
"B51703D9B51903D9B51B03D9B51D03D9B51F03D9B5300514B5310000B5320A5A"+\
"B533044CB53405DCB5350426B53604B9B5370000B5380480B5390000B53A08BB"+\
"B53B0000B53D04A6B53E044CB53F044CB540008FB54100A3B542000DB5430021"+\
"B5440014B5450028B5460021B5470035B5480038B549000CB54A0028B54B003A"+\
"B54C02E1B54D0C28B54E0480B54F0AAAB60005AAB60205AAB60405AAB60605AA"+\
"B60805AAB60A05AAB60C05AAB60E05AAB61005AAB61205AAB61405AAB61605AA"+\
"B61805AAB61A05AAB61C05AAB61E05AAB60103D9B60303D9B60503D9B60703D9"+\
"B60903D9B60B03D9B60D03D9B60F03D9B61103D9B61303D9B61503D9B61703D9"+\
"B61903D9B61B03D9B61D03D9B61F03D9B6300514B6310000B6320A5AB633044C"+\
"B63405DCB6350426B63604B9B6370000B6380480B6390000B63A08BBB63B0000"+\
"B63D04A6B63E044CB63F044CB640008FB64100A3B642000DB6430021B6440014"+\
"B6450028B6460021B6470035B6480038B649000CB64A0028B64B003AB64C02E1"+\
"B64D0C28B64E0480B64F0AAAB70005AAB70205AAB70405AAB70605AAB70805AA"+\
"B70A05AAB70C05AAB70E05AAB71005AAB71205AAB71405AAB71605AAB71805AA"+\
"B71A05AAB71C05AAB71E05AAB70103D9B70303D9B70503D9B70703D9B70903D9"+\
"B70B03D9B70D03D9B70F03D9B71103D9B71303D9B71503D9B71703D9B71903D9"+\
"B71B03D9B71D03D9B71F03D9B7300514B7310000B7320A5AB733044CB73405DC"+\
"B7350426B73604B9B7370000B7380480B7390000B73A08BBB73B0000B73D04A6"+\
"B73E044CB73F044CB740008FB74100A3B742000DB7430021B7440014B7450028"+\
"B7460021B7470035B7480038B749000CB74A0028B74B003AB74C02E1B74D0C28"+\
"B74E0480B74F0AAAB80005AAB80205AAB80405AAB80605AAB80805AAB80A05AA";

cmd_ag3="B80C05AAB80E05AAB81005AAB81205AAB81405AAB81605AAB81805AAB81A05AA"+\
"B81C05AAB81E05AAB80103D9B80303D9B80503D9B80703D9B80903D9B80B03D9"+\
"B80D03D9B80F03D9B81103D9B81303D9B81503D9B81703D9B81903D9B81B03D9"+\
"B81D03D9B81F03D9B8300514B8310000B8320A5AB833044CB83405DCB8350426"+\
"B83604B9B8370000B8380480B8390000B83A08BBB83B0000B83D04A6B83E044C"+\
"B83F044CB840008FB84100A3B842000DB8430021B8440014B8450028B8460021"+\
"B8470035B8480038B849000CB84A0028B84B003AB84C02E1B84D0C28B84E0480"+\
"B84F0AAAB90005AAB90205AAB90405AAB90605AAB90805AAB90A05AAB90C05AA"+\
"B90E05AAB91005AAB91205AAB91405AAB91605AAB91805AAB91A05AAB91C05AA"+\
"B91E05AAB90103D9B90303D9B90503D9B90703D9B90903D9B90B03D9B90D03D9"+\
"B90F03D9B91103D9B91303D9B91503D9B91703D9B91903D9B91B03D9B91D03D9"+\
"B91F03D9B9300514B9310000B9320A5AB933044CB93405DCB9350426B93604B9"+\
"B9370000B9380480B9390000B93A08BBB93B0000B93D04A6B93E044CB93F044C"+\
"B940008FB94100A3B942000DB9430021B9440014B9450028B9460021B9470035"+\
"B9480038B949000CB94A0028B94B003AB94C02E1B94D0C28B94E0480B94F0AAA";

cmd_hvoff="C00000FFC00100FFC00200FFC00300FFC00400FFC00500FFC00600FFC00700FF"+\
"C00800FFC00900FFC00A00FFC00B00FFC00C00FFC00D00FFC00E00FFC00F00FF"+\
"C01000FFC01100FFC01200FFC01300FFC01400FFC01500FFC01600FFC01700FF"+\
"C01800FFC01900FFC01A00FFC01B00FFC01C00FFC01D00FFC01E00FFC01F00FF"+\
"C02000FFC02100FFC02200FFC02300FFC02400FFC02500FFC02600FFC02700FF"+\
"C02800FFC02900FFC02A00FFC02B00FFC02C00FFC02D00FFC02E00FFC02F00FF"+\
"C03000FFC03100FFC03200FFC03300FFC03400FFC03500FFC03600FFC03700FF"+\
"C03800FFC03900FFC03A00FFC03B00FFC03C00FFC03D00FFC03E00FFC03F00FF"+\
"C04000FFC04100FFC04200FFC04300FFC04400FFC04500FFC04600FFC04700FF"+\
"C04800FFC04900FFC04A00FFC04B00FFC04C00FFC04D00FFC04E00FFC04F00FF"+\
"C05000FFC05100FFC05200FFC05300FFC05400FFC05500FFC05600FFC05700FF"+\
"C05800FFC05900FFC05A00FFC05B00FFC05C00FFC05D00FFC05E00FFC05F00FF"+\
"C06000FFC06100FFC06200FFC06300FFC06400FFC06500FFC06600FFC06700FF"+\
"C06800FFC06900FFC06A00FFC06B00FFC06C00FFC06D00FFC06E00FFC06F00FF"+\
"C07000FFC07100FFC07200FFC07300FFC07400FFC07500FFC07600FFC07700FF"+\
"C07800FFC07900FFC07A00FFC07B00FFC07C00FFC07D00FFC07E00FFC07F00FF"+\
"C08000FFC08100FFC08200FFC08300FFC08400FFC08500FFC08600FFC08700FF"+\
"C08800FFC08900FFC08A00FFC08B00FFC08C00FFC08D00FFC08E00FFC08F00FF"+\
"C09000FFC09100FFC09200FFC09300FFC09400FFC09500FFC09600FFC09700FF"+\
"C09800FFC09900FFC09A00FFC09B00FFC09C00FFC09D00FFC09E00FFC09F00FF";

cmd_hvon="C0000000C0010000C0020000C0030000C0040000C0050000C0060000C0070000"+\
"C0080000C0090000C00A0000C00B0000C00C0000C00D0000C00E0000C00F0000"+\
"C0100000C0110000C0120000C0130000C0140000C0150000C0160000C0170000"+\
"C0180000C0190000C01A0000C01B0000C01C0000C01D0000C01E0000C01F0000"+\
"C0200000C0210000C0220000C0230000C0240000C0250000C0260000C0270000"+\
"C0280000C0290000C02A0000C02B0000C02C0000C02D0000C02E0000C02F0000"+\
"C0300000C0310000C0320000C0330000C0340000C0350000C0360000C0370000"+\
"C0380000C0390000C03A0000C03B0000C03C0000C03D0000C03E0000C03F0000"+\
"C0400000C0410000C0420000C0430000C0440000C0450000C0460000C0470000"+\
"C0480000C0490000C04A0000C04B0000C04C0000C04D0000C04E0000C04F0000"+\
"C0500000C0510000C0520000C0530000C0540000C0550000C0560000C0570000"+\
"C0580000C0590000C05A0000C05B0000C05C0000C05D0000C05E0000C05F0000"+\
"C0600000C0610000C0620000C0630000C0640000C0650000C0660000C0670000"+\
"C0680000C0690000C06A0000C06B0000C06C0000C06D0000C06E0000C06F0000"+\
"C0700000C0710000C0720000C0730000C0740000C0750000C0760000C0770000"+\
"C0780000C0790000C07A0000C07B0000C07C0000C07D0000C07E0000C07F0000"+\
"C0800000C0810000C0820000C0830000C0840000C0850000C0860000C0870000"+\
"C0880000C0890000C08A0000C08B0000C08C0000C08D0000C08E0000C08F0000"+\
"C0900000C0910000C0920000C0930000C0940000C0950000C0960000C0970000"+\
"C0980000C0990000C09A0000C09B0000C09C0000C09D0000C09E0000C09F0000";

cmd_post="01234567AE000100AF000000AE000100AF008000AE000100AE008000AE000100"+\
"AE000100AF00FFFFAE000100AE000100AF008000AE000100AF050080AE000100"+\
"AF060140AE000100AF140000AE000100AF1E0000AE000100AF1F0000AE000100AF320000AE000100"+\
"AF2C0000AE000100AF2D0001AE000100AF2D0000AE000100AF330100AE000100"+\
"AF340000AE000100AF350000AE000100AF360003AE000100AF370001AE000100"+\
"AF370000AE000100AF380000AE000100AF390004AE000100AF3A0000AE000100"+\
"AF4803FFAE000100AF3D0F00AE000100AF260000AE000100AF260800AE000100"+\
"AF260000AE000100AF261080AE000100AF25C000AE000100AF4B0000AE000100"+\
"AF4C0003AE000100AF270000AE000100AF0B8001AE000100AF0A0000AE000100"+\
"AF0A0001AE000100AF0A0000AE000100AF3E0000AE000100AF460000AE000100"+\
"AF470000AE000100AF470001AE000100AF470000AE000100AF460001AE000100"+\
"AF270000AE000100AF4D0450AE000100AF4DC450AE000100AF008D0EAE000100";

ctrl.send(syncwd+cmd_pre)
time.sleep(.1)
ctrl.send(syncwd+cmd_ag1)
time.sleep(.1)
ctrl.send(syncwd+cmd_ag2)
time.sleep(.1)
ctrl.send(syncwd+cmd_ag3)
time.sleep(.1)
ctrl.send(syncwd+cmd_post)
time.sleep(.1)

ctrl.close()


